<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HIGH-CARD DOUBLE DRAW</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #D4AF37; --gold-light: #F4D03F; --gold-dark: #B8860B; --bg-deep: #0A0A0F; --bg-card: #12121A; --bg-elevated: #1A1A25; --text-primary: #FAFAFA; --text-secondary: #A0A0B0; --red-card: #C41E3A; --success: #2ECC71; --danger: #E74C3C; --blue: #3498DB; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Outfit', sans-serif; background: var(--bg-deep); color: var(--text-primary); min-height: 100vh; }
        body::before { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(ellipse at 50% 0%, rgba(196,30,58,0.08) 0%, transparent 50%); pointer-events: none; z-index: 0; }
        .container { position: relative; z-index: 1; max-width: 1000px; margin: 0 auto; padding: 15px; min-height: 100vh; }
        header { text-align: center; padding: 15px 0; position: relative; }
        .back-btn { position: absolute; top: 15px; left: 0; color: var(--text-secondary); font-size: 0.85rem; text-decoration: none; }
        .back-btn:hover { color: var(--gold); }
        .logo { font-family: 'Playfair Display', serif; font-size: clamp(1.5rem, 4vw, 2.2rem); font-weight: 700; letter-spacing: 0.08em; background: linear-gradient(135deg, var(--gold-light), var(--gold), var(--gold-dark)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .tagline { font-size: 0.65rem; letter-spacing: 0.25em; color: var(--text-secondary); text-transform: uppercase; }
        .help-link { position: absolute; top: 15px; right: 0; color: var(--gold); font-size: 0.8rem; cursor: pointer; }
        .stats-bar { display: flex; justify-content: center; gap: 25px; padding: 12px; margin: 8px 0; background: rgba(26,26,37,0.8); border: 1px solid rgba(212,175,55,0.2); border-radius: 10px; }
        .stat { text-align: center; }
        .stat-label { font-size: 0.6rem; letter-spacing: 0.12em; color: var(--text-secondary); text-transform: uppercase; }
        .stat-value { font-family: 'Playfair Display', serif; font-size: 1.2rem; font-weight: 600; color: var(--gold); }
        .stat-value.bankroll { color: var(--text-primary); }
        .game-layout { display: grid; grid-template-columns: 1fr 220px; gap: 15px; }
        @media (max-width: 750px) { .game-layout { grid-template-columns: 1fr; } .side-panel { order: -1; } }
        .main-area { display: flex; flex-direction: column; gap: 12px; }
        .table { background: linear-gradient(180deg, rgba(20,60,40,0.5), rgba(15,45,30,0.7)); border: 2px solid rgba(212,175,55,0.3); border-radius: 16px; padding: 20px; position: relative; }
        .cards-row { display: flex; justify-content: center; align-items: flex-start; gap: 50px; position: relative; }
        .card-spot { text-align: center; }
        .card-spot-label { font-size: 0.6rem; letter-spacing: 0.15em; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 6px; }
        .cards-stack { position: relative; height: 120px; width: 85px; }
        .card { width: 85px; height: 120px; border-radius: 8px; position: absolute; transform-style: preserve-3d; transition: all 0.5s ease; }
        .card.flipped { transform: rotateY(180deg); }
        .card.discarded { transform: translateX(-25px) rotate(-8deg) scale(0.85); opacity: 0.5; z-index: 0 !important; }
        .card.new-card { z-index: 2; box-shadow: 0 0 15px rgba(212,175,55,0.5); }
        .card-face { position: absolute; width: 100%; height: 100%; border-radius: 8px; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; box-shadow: 0 5px 20px rgba(0,0,0,0.4); }
        .card-back { background: linear-gradient(135deg, #1a1a2e, #0f0f1a); border: 2px solid rgba(212,175,55,0.3); }
        .card-back::before { content: ''; position: absolute; width: 55%; height: 65%; background: repeating-linear-gradient(45deg, transparent, transparent 3px, rgba(212,175,55,0.1) 3px, rgba(212,175,55,0.1) 4px); border: 1px solid rgba(212,175,55,0.2); border-radius: 4px; }
        .card-front { transform: rotateY(180deg); background: linear-gradient(180deg, #fff, #f5f5f5); color: #1C1C28; padding: 5px; }
        .card-front.red { color: var(--red-card); }
        .card-rank { position: absolute; top: 4px; left: 6px; font-family: 'Playfair Display', serif; font-size: 0.85rem; font-weight: 700; }
        .card-rank-bottom { position: absolute; bottom: 4px; right: 6px; font-family: 'Playfair Display', serif; font-size: 0.85rem; font-weight: 700; transform: rotate(180deg); }
        .card-suit { font-size: 2.2rem; }
        .card-placeholder { width: 85px; height: 120px; border-radius: 8px; border: 2px dashed rgba(212,175,55,0.3); display: flex; align-items: center; justify-content: center; color: rgba(212,175,55,0.4); font-size: 1.2rem; }
        .vs-badge { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; background: var(--bg-elevated); border: 2px solid var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: 'Playfair Display', serif; font-weight: 700; color: var(--gold); font-size: 0.85rem; z-index: 5; }
        .actions { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        .btn { padding: 10px 28px; font-family: 'Outfit', sans-serif; font-size: 0.8rem; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; border: none; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-gold { background: linear-gradient(135deg, var(--gold-light), var(--gold), var(--gold-dark)); color: var(--bg-deep); }
        .btn-red { background: linear-gradient(135deg, #E74C3C, #C0392B); color: white; }
        .btn-green { background: linear-gradient(135deg, var(--success), #27AE60); color: white; }
        .btn:hover:not(:disabled) { transform: translateY(-2px); }
        .result { text-align: center; padding: 12px 20px; border-radius: 10px; font-weight: 600; font-size: 0.95rem; }
        .result-win { background: rgba(46,204,113,0.15); border: 1px solid rgba(46,204,113,0.4); color: var(--success); }
        .result-lose { background: rgba(231,76,60,0.15); border: 1px solid rgba(231,76,60,0.4); color: var(--danger); }
        .result-push { background: rgba(52,152,219,0.15); border: 1px solid rgba(52,152,219,0.4); color: var(--blue); }
        .side-panel { display: flex; flex-direction: column; gap: 10px; }
        .panel { background: var(--bg-elevated); border: 1px solid rgba(212,175,55,0.2); border-radius: 12px; padding: 14px; }
        .panel-title { font-family: 'Playfair Display', serif; font-size: 0.9rem; color: var(--gold); margin-bottom: 10px; text-align: center; padding-bottom: 8px; border-bottom: 1px solid rgba(212,175,55,0.2); }
        .bet-row { display: flex; align-items: center; gap: 6px; margin-bottom: 10px; }
        .bet-row label { font-size: 0.7rem; color: var(--text-secondary); min-width: 55px; }
        .bet-input { flex: 1; padding: 8px 10px; font-family: 'Playfair Display', serif; font-size: 1rem; text-align: center; background: var(--bg-card); border: 1px solid rgba(212,175,55,0.3); border-radius: 6px; color: var(--text-primary); outline: none; }
        .bet-input:focus { border-color: var(--gold); }
        .quick-bets { display: flex; gap: 5px; justify-content: center; margin-bottom: 10px; flex-wrap: wrap; }
        .quick-bet { padding: 5px 10px; font-size: 0.7rem; background: var(--bg-card); border: 1px solid rgba(212,175,55,0.2); border-radius: 5px; color: var(--text-secondary); cursor: pointer; }
        .quick-bet:hover { border-color: var(--gold); color: var(--gold); }
        .side-bets-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .side-bets-header span { font-size: 0.7rem; color: var(--text-secondary); }
        .side-bet-amount-row { display: flex; align-items: center; gap: 6px; margin-bottom: 12px; padding-bottom: 10px; border-bottom: 1px solid rgba(212,175,55,0.15); }
        .side-bet-amount-row label { font-size: 0.7rem; color: var(--gold); }
        .side-bet-input { width: 70px; padding: 6px 8px; font-family: 'Playfair Display', serif; font-size: 0.9rem; text-align: center; background: var(--bg-card); border: 1px solid rgba(212,175,55,0.3); border-radius: 6px; color: var(--text-primary); outline: none; }
        .side-bet-input:focus { border-color: var(--gold); }
        .side-bet-note { font-size: 0.6rem; color: var(--text-secondary); margin-left: auto; }
        .side-bet { display: flex; align-items: center; padding: 6px 8px; margin-bottom: 5px; background: var(--bg-card); border: 1px solid rgba(212,175,55,0.1); border-radius: 6px; }
        .side-bet.won { border-color: var(--success); background: rgba(46,204,113,0.1); }
        .side-bet.lost { border-color: var(--danger); opacity: 0.5; }
        .side-bet-info { flex: 1; }
        .side-bet-name { font-size: 0.75rem; font-weight: 600; color: var(--text-primary); }
        .side-bet-payout { font-size: 0.6rem; color: var(--gold); }
        .total-row { display: flex; justify-content: space-between; padding-top: 8px; margin-top: 6px; border-top: 1px solid rgba(212,175,55,0.2); font-size: 0.8rem; }
        .total-label { color: var(--text-secondary); }
        .total-value { color: var(--gold); font-weight: 600; }
        .shoe-indicator { position: fixed; bottom: 12px; right: 12px; background: var(--bg-elevated); border: 1px solid rgba(212,175,55,0.2); border-radius: 8px; padding: 8px 12px; font-size: 0.7rem; color: var(--text-secondary); }
        .shoe-indicator span { color: var(--gold); font-weight: 600; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; visibility: hidden; transition: all 0.3s; }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        .modal { background: var(--bg-elevated); border: 1px solid rgba(212,175,55,0.3); border-radius: 16px; padding: 25px; max-width: 480px; max-height: 80vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid rgba(212,175,55,0.2); }
        .modal-title { font-family: 'Playfair Display', serif; font-size: 1.3rem; color: var(--gold); }
        .modal-close { width: 30px; height: 30px; border-radius: 50%; background: var(--bg-card); border: 1px solid rgba(212,175,55,0.2); color: var(--text-secondary); cursor: pointer; font-size: 1.1rem; }
        .modal-content h3 { font-family: 'Playfair Display', serif; font-size: 0.95rem; color: var(--gold); margin: 12px 0 6px; }
        .modal-content p, .modal-content li { color: var(--text-secondary); line-height: 1.5; font-size: 0.85rem; margin-bottom: 4px; }
        .modal-content ul { list-style: none; padding-left: 12px; }
        .modal-content li::before { content: '‚óÜ'; color: var(--gold); margin-right: 6px; font-size: 0.45em; }
        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a class="back-btn" href="index.html">‚Üê Lobby</a>
            <h1 class="logo">HIGH-CARD DOUBLE DRAW</h1>
            <p class="tagline">Beat the Dealer</p>
            <a class="help-link" id="helpBtn">? Rules</a>
        </header>
        <div class="stats-bar">
            <div class="stat"><div class="stat-label">Bankroll</div><div class="stat-value bankroll" id="bankroll">$1,000</div></div>
            <div class="stat"><div class="stat-label">Main Bet</div><div class="stat-value" id="mainBetDisplay">$0</div></div>
            <div class="stat"><div class="stat-label">Last Win</div><div class="stat-value" id="lastWin">-</div></div>
        </div>
        <div class="game-layout">
            <div class="main-area">
                <div class="table">
                    <div class="cards-row">
                        <div class="card-spot"><div class="card-spot-label">Your Card</div><div class="cards-stack" id="playerStack"><div class="card-placeholder">?</div></div></div>
                        <div class="vs-badge">VS</div>
                        <div class="card-spot"><div class="card-spot-label">Dealer</div><div class="cards-stack" id="dealerStack"><div class="card-placeholder">?</div></div></div>
                    </div>
                </div>
                <div id="resultArea" class="hidden"></div>
                <div class="actions" id="actionsArea"><button class="btn btn-green" id="dealBtn">Deal</button></div>
                <div class="actions hidden" id="playerActions"><button class="btn btn-gold" id="standBtn">Stand</button><button class="btn btn-red" id="doubleBtn">Double & Draw</button></div>
                <div class="actions hidden" id="newHandActions"><button class="btn btn-green" id="newHandBtn">New Hand</button></div>
            </div>
            <div class="side-panel">
                <div class="panel">
                    <div class="panel-title">Main Bet</div>
                    <div class="bet-row"><label>Amount:</label><input type="number" class="bet-input" id="betInput" value="10" min="1"></div>
                    <div class="quick-bets">
                        <button class="quick-bet" data-amt="10">$10</button>
                        <button class="quick-bet" data-amt="25">$25</button>
                        <button class="quick-bet" data-amt="50">$50</button>
                        <button class="quick-bet" data-amt="100">$100</button>
                    </div>
                </div>
                <div class="panel">
                    <div class="panel-title">Side Bets (All 6)</div>
                    <div class="side-bet-amount-row">
                        <label>Bet per side:</label>
                        <input type="number" class="side-bet-input" id="sideBetInput" value="0" min="0">
                        <span class="side-bet-note">√ó 6 bets</span>
                    </div>
                    <div class="side-bet" data-sb="naturalAce"><div class="side-bet-info"><div class="side-bet-name">Natural Ace</div><div class="side-bet-payout">10:1 ‚Äî First card is Ace</div></div></div>
                    <div class="side-bet" data-sb="dealerBreaks"><div class="side-bet-info"><div class="side-bet-name">Dealer Breaks</div><div class="side-bet-payout">3:1 ‚Äî Dealer redraws lower</div></div></div>
                    <div class="side-bet" data-sb="faceWinner"><div class="side-bet-info"><div class="side-bet-name">Face Value Winner</div><div class="side-bet-payout">2:1 ‚Äî Winner is J/Q/K/A</div></div></div>
                    <div class="side-bet" data-sb="mirror"><div class="side-bet-info"><div class="side-bet-name">Mirror</div><div class="side-bet-payout">10:1 ‚Äî Same rank</div></div></div>
                    <div class="side-bet" data-sb="twinFlames"><div class="side-bet-info"><div class="side-bet-name">Twin Flames</div><div class="side-bet-payout">60:1 ‚Äî Same rank + suit</div></div></div>
                    <div class="side-bet" data-sb="lottery"><div class="side-bet-info"><div class="side-bet-name">The Lottery</div><div class="side-bet-payout">750:1 ‚Äî Both Ace, same suit</div></div></div>
                    <div class="total-row"><span class="total-label">Side Bets Total:</span><span class="total-value" id="sideBetsTotal">$0</span></div>
                </div>
            </div>
        </div>
    </div>
    <div class="shoe-indicator">üÉè <span id="shoeCount">156</span></div>
    <div class="modal-overlay" id="rulesModal">
        <div class="modal">
            <div class="modal-header"><h2 class="modal-title">How to Play</h2><button class="modal-close" id="closeModal">√ó</button></div>
            <div class="modal-content">
                <p>Beat the dealer's card to win!</p>
                <h3>Basic Play</h3><ul><li>Higher card wins (A highest, 2 lowest)</li><li>Ties push</li></ul>
                <h3>Your Options</h3><ul><li><strong>Stand:</strong> Keep your card (1x bet)</li><li><strong>Double & Draw:</strong> Discard & redraw (2x bet)</li></ul>
                <h3>Special Rules</h3><ul><li><strong>Natural Ace:</strong> Stand on Ace & win = 3:2</li><li><strong>Dealer Hits:</strong> Dealer redraws on 2-6</li></ul>
                <h3>Side Bets</h3><ul><li>Natural Ace 10:1</li><li>Dealer Breaks 3:1</li><li>Face Winner 2:1</li><li>Mirror 10:1</li><li>Twin Flames 60:1</li><li>Lottery 750:1</li></ul>
            </div>
        </div>
    </div>
    <script>
        const DECKS=3,CUT=30,DEALER_HIT=6,KEY='prestige_casino_bankroll';
        const RANKS=['2','3','4','5','6','7','8','9','10','J','Q','K','A'],SUITS=['‚ô•','‚ô¶','‚ô†','‚ô£'];
        const RANK_VAL={2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13,A:14};
        const SB_PAY={naturalAce:10,dealerBreaks:3,faceWinner:2,mirror:10,twinFlames:60,lottery:750};
        let S={bankroll:1000,shoe:[],hand:null};
        const E={bankroll:document.getElementById('bankroll'),mainBetDisplay:document.getElementById('mainBetDisplay'),lastWin:document.getElementById('lastWin'),betInput:document.getElementById('betInput'),sideBetInput:document.getElementById('sideBetInput'),playerStack:document.getElementById('playerStack'),dealerStack:document.getElementById('dealerStack'),resultArea:document.getElementById('resultArea'),actionsArea:document.getElementById('actionsArea'),playerActions:document.getElementById('playerActions'),newHandActions:document.getElementById('newHandActions'),dealBtn:document.getElementById('dealBtn'),standBtn:document.getElementById('standBtn'),doubleBtn:document.getElementById('doubleBtn'),newHandBtn:document.getElementById('newHandBtn'),sideBetsTotal:document.getElementById('sideBetsTotal'),shoeCount:document.getElementById('shoeCount'),rulesModal:document.getElementById('rulesModal'),helpBtn:document.getElementById('helpBtn'),closeModal:document.getElementById('closeModal')};
        const load=()=>{S.bankroll=parseInt(localStorage.getItem(KEY))||1000;};
        const save=()=>{localStorage.setItem(KEY,S.bankroll.toString());};
        const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;};
        const makeShoe=()=>{const s=[];for(let d=0;d<DECKS;d++)for(const su of SUITS)for(const r of RANKS)s.push({rank:r,suit:su,value:RANK_VAL[r]});return shuffle(s);};
        const draw=()=>{if(S.shoe.length<CUT)S.shoe=makeShoe();E.shoeCount.textContent=S.shoe.length-1;return S.shoe.pop();};
        const isRed=su=>su==='‚ô•'||su==='‚ô¶';
        const isFace=r=>['J','Q','K','A'].includes(r);
        const updateDisplay=()=>{E.bankroll.textContent='$'+S.bankroll.toLocaleString();};
        const updateSideTotal=()=>{const amt=parseInt(E.sideBetInput.value)||0;E.sideBetsTotal.textContent='$'+(amt*6);};
        const renderCard=(c,flipped=false)=>{const d=document.createElement('div');d.className='card'+(flipped?' flipped':'');d.innerHTML=`<div class="card-face card-back"></div><div class="card-face card-front ${isRed(c.suit)?'red':''}"><span class="card-rank">${c.rank}</span><span class="card-suit">${c.suit}</span><span class="card-rank-bottom">${c.rank}</span></div>`;return d;};
        const placeholder=()=>{const d=document.createElement('div');d.className='card-placeholder';d.textContent='?';return d;};
        const showResult=(txt,type)=>{E.resultArea.className='result result-'+type;E.resultArea.textContent=txt;E.resultArea.classList.remove('hidden');};
        const hideResult=()=>E.resultArea.classList.add('hidden');
        const deal=()=>{
            const mainBet=parseInt(E.betInput.value)||0;
            const sbAmt=parseInt(E.sideBetInput.value)||0;
            const totalBet=mainBet+sbAmt*6;
            if(mainBet<1)return alert('Min bet $1');
            if(totalBet>S.bankroll)return alert('Not enough');
            S.bankroll-=totalBet;save();updateDisplay();
            S.hand={mainBet,sbAmt,playerCard1:draw(),dealerCard1:draw(),playerFinal:null,dealerFinal:null,playerDiscarded:null,dealerDiscarded:null,doubled:false,dealerHit:false};
            E.mainBetDisplay.textContent='$'+mainBet;
            E.playerStack.innerHTML='';E.dealerStack.innerHTML='';
            const pCard=renderCard(S.hand.playerCard1);E.playerStack.appendChild(pCard);setTimeout(()=>pCard.classList.add('flipped'),100);
            const dCard=renderCard(S.hand.dealerCard1);E.dealerStack.appendChild(dCard);
            E.actionsArea.classList.add('hidden');E.playerActions.classList.remove('hidden');E.newHandActions.classList.add('hidden');hideResult();
            E.doubleBtn.disabled=mainBet>S.bankroll;
            document.querySelectorAll('.side-bet').forEach(el=>el.classList.remove('won','lost'));
        };
        const stand=()=>{S.hand.playerFinal=S.hand.playerCard1;resolveHand();};
        const doubleAndDraw=()=>{
            if(S.hand.mainBet>S.bankroll)return alert('Not enough to double');
            S.bankroll-=S.hand.mainBet;save();updateDisplay();
            S.hand.doubled=true;S.hand.mainBet*=2;S.hand.playerDiscarded=S.hand.playerCard1;
            E.mainBetDisplay.textContent='$'+S.hand.mainBet;
            const newC=draw();S.hand.playerFinal=newC;
            const old=E.playerStack.querySelector('.card');old.classList.add('discarded');
            const nc=renderCard(newC);nc.classList.add('new-card');E.playerStack.appendChild(nc);setTimeout(()=>nc.classList.add('flipped'),100);
            setTimeout(resolveHand,600);
        };
        const resolveHand=()=>{
            E.playerActions.classList.add('hidden');
            const dCard=E.dealerStack.querySelector('.card');setTimeout(()=>dCard.classList.add('flipped'),200);
            setTimeout(()=>{
                if(S.hand.dealerCard1.value<=DEALER_HIT){
                    S.hand.dealerHit=true;S.hand.dealerDiscarded=S.hand.dealerCard1;
                    const newD=draw();S.hand.dealerFinal=newD;
                    dCard.classList.add('discarded');
                    const nd=renderCard(newD);nd.classList.add('new-card');E.dealerStack.appendChild(nd);setTimeout(()=>nd.classList.add('flipped'),100);
                    setTimeout(calcResult,600);
                }else{S.hand.dealerFinal=S.hand.dealerCard1;calcResult();}
            },400);
        };
        const calcResult=()=>{
            const h=S.hand,pVal=h.playerFinal.value,dVal=h.dealerFinal.value;
            let mainProfit=0,rType='',rText='';
            if(pVal>dVal){const natAce=!h.doubled&&h.playerCard1.rank==='A';mainProfit=natAce?h.mainBet*1.5:h.mainBet;rText=natAce?`Natural Ace WIN! +$${mainProfit}`:`WIN! +$${mainProfit}`;rType='win';}
            else if(pVal<dVal){mainProfit=-h.mainBet;rText=`LOSE -$${h.mainBet}`;rType='lose';}
            else{mainProfit=0;rText='PUSH';rType='push';}
            let sideWin=0;const sbAmt=h.sbAmt;
            if(sbAmt>0){
                const sbEls={naturalAce:document.querySelector('[data-sb="naturalAce"]'),dealerBreaks:document.querySelector('[data-sb="dealerBreaks"]'),faceWinner:document.querySelector('[data-sb="faceWinner"]'),mirror:document.querySelector('[data-sb="mirror"]'),twinFlames:document.querySelector('[data-sb="twinFlames"]'),lottery:document.querySelector('[data-sb="lottery"]')};
                if(h.playerCard1.rank==='A'){sideWin+=sbAmt*SB_PAY.naturalAce+sbAmt;sbEls.naturalAce.classList.add('won');}else sbEls.naturalAce.classList.add('lost');
                if(h.dealerHit&&h.dealerFinal.value<h.dealerDiscarded.value){sideWin+=sbAmt*SB_PAY.dealerBreaks+sbAmt;sbEls.dealerBreaks.classList.add('won');}else sbEls.dealerBreaks.classList.add('lost');
                if(pVal!==dVal){const winner=pVal>dVal?h.playerFinal:h.dealerFinal;if(isFace(winner.rank)){sideWin+=sbAmt*SB_PAY.faceWinner+sbAmt;sbEls.faceWinner.classList.add('won');}else sbEls.faceWinner.classList.add('lost');}else sbEls.faceWinner.classList.add('lost');
                if(h.playerFinal.rank===h.dealerFinal.rank){sideWin+=sbAmt*SB_PAY.mirror+sbAmt;sbEls.mirror.classList.add('won');}else sbEls.mirror.classList.add('lost');
                if(h.playerFinal.rank===h.dealerFinal.rank&&h.playerFinal.suit===h.dealerFinal.suit){sideWin+=sbAmt*SB_PAY.twinFlames+sbAmt;sbEls.twinFlames.classList.add('won');}else sbEls.twinFlames.classList.add('lost');
                if(h.playerFinal.rank==='A'&&h.dealerFinal.rank==='A'&&h.playerFinal.suit===h.dealerFinal.suit){sideWin+=sbAmt*SB_PAY.lottery+sbAmt;sbEls.lottery.classList.add('won');}else sbEls.lottery.classList.add('lost');
            }
            if(mainProfit>=0)S.bankroll+=h.mainBet+mainProfit;
            S.bankroll+=sideWin;
            save();updateDisplay();
            const totalProfit=mainProfit+sideWin-(sbAmt*6);
            if(sideWin>0)rText+=` | Side bets: +$${sideWin}`;
            showResult(rText,rType);
            if(totalProfit>0){E.lastWin.textContent='+$'+totalProfit;E.lastWin.style.color='var(--success)';}
            else if(totalProfit<0){E.lastWin.textContent='-$'+Math.abs(totalProfit);E.lastWin.style.color='var(--danger)';}
            else{E.lastWin.textContent='$0';E.lastWin.style.color='var(--blue)';}
            E.newHandActions.classList.remove('hidden');
        };
        const newHand=()=>{hideResult();E.newHandActions.classList.add('hidden');E.actionsArea.classList.remove('hidden');E.playerStack.innerHTML='';E.dealerStack.innerHTML='';E.playerStack.appendChild(placeholder());E.dealerStack.appendChild(placeholder());E.mainBetDisplay.textContent='$0';document.querySelectorAll('.side-bet').forEach(el=>el.classList.remove('won','lost'));S.hand=null;};
        E.dealBtn.onclick=deal;E.standBtn.onclick=stand;E.doubleBtn.onclick=doubleAndDraw;E.newHandBtn.onclick=newHand;
        document.querySelectorAll('.quick-bet').forEach(b=>b.onclick=()=>E.betInput.value=b.dataset.amt);
        E.sideBetInput.oninput=updateSideTotal;
        E.helpBtn.onclick=()=>E.rulesModal.classList.add('active');E.closeModal.onclick=()=>E.rulesModal.classList.remove('active');E.rulesModal.onclick=e=>{if(e.target===E.rulesModal)E.rulesModal.classList.remove('active');};
        load();S.shoe=makeShoe();updateDisplay();updateSideTotal();
    </script>
</body>
</html>
